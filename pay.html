<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex,nofollow">
<title>–¢”©–ª–±”©—Ä –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö ‚Äî LifeCheck</title>
<meta name="description" content="–¢”©–ª–±”©—Ä”©”© —à–∞–ª–≥–∞–∞–¥, —Ö—É–≤–∏–π–Ω PDF —Ç–∞–π–ª–∞–Ω–≥–∞–∞ –∏–º—ç–π–ª—ç—ç—Ä –∞–≤–∞–∞—Ä–∞–π.">
<meta property="og:title" content="–¢”©–ª–±”©—Ä –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞—Ö ‚Äî LifeCheck">
<meta property="og:description" content="LifeCheck: —Ö—É–≤—å —Ö“Ø–Ω–∏–π —ç—Ä—Å–¥—ç–ª–∏–π–Ω –±–æ–≥–∏–Ω–æ —Ç–µ—Å—Ç“Ø“Ø–¥.">
<meta property="og:url" content="https://lifecheck.mn/pay.html">

  <link rel="canonical" href="https://lifecheck.mn/">
<meta name="theme-color" content="#F97316">

<!-- Open Graph -->
<meta property="og:locale" content="mn_MN">
<meta property="og:site_name" content="LifeCheck.mn">
<meta property="og:type" content="website">
<meta property="og:image" content="https://lifecheck.mn/images/og/lifecheck-og.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://lifecheck.mn/images/og/lifecheck-og.jpg">

<!-- Icons -->
<link rel="icon" href="/images/favicon-32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/images/favicon-192.png" sizes="192x192" type="image/png">
<link rel="apple-touch-icon" href="/images/apple-touch-icon.png" sizes="180x180">

  
  <link rel="stylesheet" href="/assets/style.css" />
  <link rel="stylesheet" href="/assets/header.css">
  <link rel="stylesheet" href="/assets/footer.css">
  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
  .pay-card {
  padding: 50px;
  display: flex;
  flex-direction: column;
  gap: 32px;
  background: linear-gradient(
    315deg,              /* 135 ‚Üí 315 = reverse */
    #f8cbab 0%,          /* –±—É–¥–≥—ç—Ä“Ø“Ø–ª—Å—ç–Ω peach (soft orange) */
    #ffffff 100%         /* white fade */
  );
  backdrop-filter: blur(12px);
  border-radius: 24px;
  box-shadow:  0 4px 16px rgba(0, 0, 0, 0.1);
}

.pay-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
}

@media (min-width: 768px) {
  .pay-content {
    flex-direction: row;
    gap: 40px; /* left/right columns —Ö–æ–æ—Ä–æ–Ω–¥—ã–Ω –∑–∞–π */
    justify-content: space-between;
  }
  .pay-left, .pay-right {
    flex: 1;
  }
  .pay-right {
    flex: 0 0 280px; /* QR + button –±–∞–≥—Ç–∞—Ö ”©—Ä–≥”©–Ω */
    text-align: center;
    align-items: center;
  }
  .pay-right img {
    max-width: 100%;
    height: auto;
    margin-bottom: 16px;
  }
}

.pay-left { text-align:center;}

.pay-left h3 {
  font-size: 1rem;
  font-weight: 600;
  color: #475569;
  position: relative;
  display: inline-block;
  padding-bottom: 10px;   /* underline-—Ç—ç–π –∑–∞–π */
  margin-bottom: 10px;   /* –¥–æ–æ—Ä—Ö —Ç–µ–∫—Å—Ç—Ç—ç–π –∑–∞–π */
}

.pay-left h3::after {
  content: "";
  position: absolute;
  left: 50%;
  bottom: 0;
  transform: translateX(-50%);
  width: 60%;
  height: 3px;
  border-radius: 2px;
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
}

/* section blocks –∂–∏–≥–¥ spacing-—Ç—ç–π –±–∞–π–ª–≥–∞—Ö */
.pay-left > * + * {
  margin-top: 24px;
}

.pay-left p {
  font-size: 1.05rem;      /* –∞—Ä–∞–π —Ç–æ–º */
  font-weight: 500;
  color: #1e293b;          /* –∏–ª“Ø“Ø —Ç–æ–¥ —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞ */
  margin: 0 0 16px;        /* –¥–æ–æ–≥—É—É—Ä –∑–∞–π */
}

/* –°“Ø“Ø–ª–¥ “Ø–Ω—ç / countdown */
.pay-left .price {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--accent1); /* gradient-—Ç–∞–π accent color */
  margin: 12px 0 6px;
}

#countdown {
  display: inline-block;
  padding: 2px 8px;
  margin: 0 4px;
  border-radius: 6px;
  background: rgba(99,102,241,0.08); /* accent ”©–Ω–≥”©–Ω–∏–π —Å—É–ª —Ö—É–≤–∏–ª–±–∞—Ä */
  font-weight: 600;
  color: #334155;
}

.pay-left .hint {
  font-size: 0.85rem;
  color: #64748b;
}

.pay-right img {
  max-width: 100%;
  height: auto;
  margin-bottom: 16px;
}

.pay-right .button {
  width: 100%;
  margin-bottom: 8px;
}

.qr-block {
  padding: 5px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.qr-block img {
  max-width: 200px;
  height: auto;
}

/* button style */
.pay-btn {
  display: block;
  width: auto;
  padding: 14px 20px;
  border-radius: 24px;
  border: none;
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
  color: #fff;
  font-size: 1rem;
  font-weight: 600;
  text-align: center;
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  margin: 0 auto;
}

.pay-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.12);
}

.pay-btn:active {
  transform: translateY(0);
  box-shadow: 0 3px 8px rgba(0,0,0,0.08);
}

/* –ì–∞—Ä—á–∏–≥–Ω—ã –¥–∞—Ä–∞–∞–≥–∏–π–Ω –º”©—Ä (Burnout Test ‚Äî #...) */
.pay-left h3 + p {
  font-size: 0.9rem;
  font-style: italic;
  color: #334155;
}

/* –ò–º—ç–π–ª –º”©—Ä */
.pay-left .email {
  font-size: 0.9rem;
  font-style: italic;
  color: #334155;
}

#user-email {
  margin-bottom: 40px; /* –∏–º—ç–π–ª –±–∞ “Ø–Ω—ç —Ö–æ–æ—Ä–æ–Ω–¥—ã–Ω –∑–∞–π */
}
.price {
  font-size: 1.1rem;
  font-weight: 600;
  margin: 12px 0;
  color: #1e293b;
}

.price .old-price {
  text-decoration: line-through;
  color: #9ca3af; /* —Å–∞–∞—Ä–∞–ª, –±“Ø–¥–≥—ç—Ä—Å—ç–Ω */
  margin-right: 6px;
  font-weight: 400;
}

.price .new-price {
  color: var(--accent1); /* –≥–æ–ª ”©–Ω–≥”© */
  font-weight: 700;
}

.section-title {
  display: block;        /* inline-block –±–∏—à, –±“Ø—Ç—ç–Ω –º”©—Ä —ç–∑—ç–ª–Ω—ç */
  text-align: center;    /* –¥–æ—Ç—Ä–æ–æ —Ç–µ–∫—Å—Ç—ç—ç —Ç”©–≤–¥ –≥–∞—Ä–≥–∞–Ω–∞ */
  font-size: 2rem;
  font-weight: 700;
  color: #1e293b;
  padding-bottom: 10px;
  margin: 32px 0;
  position: relative;
}

.section-title::after {
  content: "";
  position: absolute;
  left: 50%;
  bottom: 0;
  transform: translateX(-50%);
  width: 20%;
  height: 3px;
  border-radius: 2px;
  background: linear-gradient(90deg, var(--accent1), var(--accent2));
}

main.container.pay-container {
  display: block;          /* .container-–∏–π–Ω flex-–∏–π–≥ —Ö“Ø—á–∏–Ω–≥“Ø–π –±–æ–ª–≥–æ–Ω–æ */
  padding-bottom: 40px;      /* mobile –¥—ç—ç—Ä */
  box-sizing: border-box;
}

@media (min-width: 768px) {
  main.container.pay-container {
    padding: 100px 20px;   /* desktop –¥—ç—ç—Ä */
  }
}

.qr-block .qr-note{
  font-size: 0.7rem;
  font-weight: 400;
  font-style: italic;
  color: #334155;          /* subtle, clean */
  margin: 0 0 10px;        /* –¥–æ–æ—Ä–æ–æ –ª –∑–∞–π */
  text-align: center;
  letter-spacing: .2px;    /* –∂–∞–∞—Ö–∞–Ω premium –º—ç–¥—Ä—ç–º–∂ */
}

@media (min-width: 768px){
  .qr-block .qr-note{ 
    font-size: 0.7rem;
    font-weight: 400;
    font-style: italic; 
  }
}

/* Solo —Ç”©–ª”©–≤: –∑”©–≤—Ö”©–Ω loading/success —Ö–∞—Ä—É—É–ª–Ω–∞ */
.pay-content.solo { flex-direction: column; align-items: center; gap: 16px; }
.pay-content.solo .pay-left,
.pay-content.solo .qr-block,
.pay-content.solo .bank-title,
.pay-content.solo #bank-icons { display: none !important; }

/* Solo “Ø–µ–¥ message –±–ª–æ–∫ —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞ */
.pay-content.solo #loading-block,
.pay-content.solo #success-block { display: block !important; }


  </style>
</head>
<body>

  <header class="site-header">
      <div class="header-inner container">
      <!-- Logo (left) -->
      <a href="/" class="logo-link">
      <img src="images/lifechecklogo.svg" alt="LifeCheck" class="logo-img" />
      </a>

      <!-- Tip (center, desktop only) -->
      <span class="header-tip" id="header-tip">üòä ”®–Ω”©”©–¥—Ä–∏–π–Ω –∑”©–≤–ª”©–º–∂: 5 –º–∏–Ω—É—Ç –∞–ª—Ö</span>

      <!-- Right side: nav + cta (desktop) -->
      <div class="header-right">
      <nav class="nav-links">
        <a href="/tests.html">–¢–µ—Å—Ç“Ø“Ø–¥</a>
        <a href="/about.html">–¢—É—Ö–∞–π</a>
      </nav>
      <a href="/tests/wizard.html" class="header-cta">üîÆ –®–∏–¥—ç—Ç –¢–µ—Å—Ç</a>
      </div>

     <!-- Mobile hamburger -->
      <button class="hamburger" aria-label="Menu">
      <span></span><span></span><span></span>
      </button>

      <!-- Dropdown (mobile only, JS —á–∏–Ω—å —à—É—É–¥ –∞–∂–∏–ª–ª–∞–Ω–∞) -->
      <div class="dropdown-menu">
      <a href="/tests.html">–¢–µ—Å—Ç“Ø“Ø–¥</a>
      <a href="/about.html">–¢—É—Ö–∞–π</a>
      <a href="/tests/wizard.html" class="header-cta">üîÆ –®–∏–¥—ç—Ç –¢–µ—Å—Ç</a>
      </div>
      </div>
     </header>

  <main class="container pay-container">
    
    <h3 class="section-title">–¢”©–ª–±”©—Ä–∏–π–Ω —Ö—ç—Å—ç–≥</h3>
    
    <div class="pay-card">
  <div class="pay-content">
    <div class="pay-left">
  <h3>–°–æ–Ω–≥–æ—Å–æ–Ω —Ç–µ—Å—Ç</h3>
  <p id="test-name">....</p>
  <p id="test-id"></p> <!-- üÜï Test ID -->
  <p id="pay-number" style="display:none;"></p> <!-- üÜï Invoice number -->

  <h3>–ò–º—ç–π–ª —Ö–∞—è–≥</h3>
  <p id="user-email">hellothere@lifecheck.mn</p>

  <p class="price">
    –¢”©–ª–±”©—Ä: <span class="old-price">19,900‚ÇÆ</span> <span class="new-price">6,900‚ÇÆ</span>
  </p>

  <p class="hint">‚è≥<span id="countdown">13:43</span> —Ö“Ø—á–∏–Ω—Ç—ç–π</p>
</div>

    <div class="pay-right">
      <div class="qr-block">
        <p class="qr-note">–¢–∞ QR –∫–æ–¥ —É–Ω—à—É—É–ª–∂ —Ç”©–ª–±”©—Ä”©”© —Ç”©–ª–Ω”© “Ø“Ø</p>
        <img src="" alt="QR code" />
      </div>

      <p class="bank-title" style="font-weight:600;color:#334155;margin-top:8px;margin-bottom:4px;font-size:0.9rem;text-align:center;">
      üè¶ –ë–∞–Ω–∫–Ω—ã –∞–ø–ø-–∞–∞—Ä —Ç”©–ª”©—Ö
      </p>

      <div id="bank-icons" style="display:flex;justify-content:center;flex-wrap:wrap;gap:10px;margin-top:12px;"></div>
      <!-- Loading / Success –±–ª–æ–∫ -->
      <div id="loading-block" style="display:none; text-align:center; margin-top:16px;">
      <p>–¢–∞–π–ª–∞–Ω–≥ –±—ç–ª–¥—ç–∂ –±–∞–π–Ω–∞. –¢“Ø—Ä —Ö“Ø–ª—ç—ç–Ω—ç “Ø“Ø‚Ä¶</p>
      </div>

      <div id="success-block" style="display:none; text-align:center; margin-top:16px;">
      <p>–¢–∞–π–ª–∞–Ω –∞–º–∂–∏–ª—Ç—Ç–∞–π –∏–ª–≥—ç—ç–≥–¥–ª—ç—ç.</p>
      <p>–ò–º—ç–π–ª—ç—ç —à–∞–ª–≥–∞–Ω–∞ —É—É. –•–∞—Ä–∞–≥–¥–∞—Ö–≥“Ø–π –±–æ–ª Spam/Junk –±–æ–ª–æ–Ω Gmail-–∏–π–Ω Promotions —Ç–∞–±—ã–≥ –±–∞—Å —à–∞–ª–≥–∞–∞—Ä–∞–π.</p>
      </div>

    </div>
  </div>
</div>

  </main>

  <!-- FOOTER -->
      <footer class="site-footer">
        <div class="footer-inner">
        <!-- Left side -->
        <div class="footer-left">
        <img src="images/lifechecklogo.svg" alt="LifeCheck" class="footer-logo" />
        <div class="footer-tagline">–ê–º—å–¥—Ä–∞–ª–∞–∞ —à–∞–ª–≥–∞. –≠—Ä—Å–¥–ª—ç—ç —ç—Ä—Ç —Ö–∞—Ä.</div>
        </div>

        <!-- Right side -->
        <div class="footer-right">
        <div class="footer-social">
        <a href="#"><i class="fab fa-facebook-f"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
        </div>
        <div class="footer-copy">¬© 2025 LifeCheck.mn</div>
        </div>
        </div>
      </footer>
  <script src="/assets/test.js"></script>
  <script>
  (async function(){
  const TEST_NAMES = {
    burnout:  "Burnout Test",
    redflags: "Relationship Red Flags Test",
    future:   "Future Readiness Test",
    money:    "Money Mindset Test",
  };

  // 1) local/sessionStorage-—Å Test Key + ID
  const key    = (sessionStorage.getItem("testKey") || localStorage.getItem("lc_test") || "generic").toLowerCase();
  const testId = sessionStorage.getItem("testId")   || localStorage.getItem("lc_testId") || "";
  const rawEmail = sessionStorage.getItem("wizardEmail") || localStorage.getItem("lc_email") || "";

  // 2) –¢–µ—Å—Ç–∏–π–Ω –Ω—ç—Ä + ID-–≥ —Ö–∞—Ä—É—É–ª–∞—Ö
  const nameEl = document.getElementById("test-name");
  if (nameEl) {
    nameEl.textContent = `${TEST_NAMES[key] || "LifeCheck Test"} ‚Äî ${testId || "..."}`;
  }

  // 3) –ò–º—ç–π–ª–∏–π–≥ –º–∞—Å–∫–∞–ª–∂ —Ö–∞—Ä—É—É–ª–∞—Ö
  function maskEmail(email){
    const [local, domain] = (email||'').split('@');
    if (!domain || local.length <= 4) return email || '(–∏–º—ç–π–ª –±–∞–π—Ö–≥“Ø–π)';
    return `${local.slice(0,2)}${'*'.repeat(local.length-4)}${local.slice(-2)}@${domain}`;
  }
  const emailEl = document.getElementById("user-email");
  if (emailEl) emailEl.textContent = rawEmail ? maskEmail(rawEmail) : "(–∏–º—ç–π–ª –±–∞–π—Ö–≥“Ø–π)";

  // 4) Countdown (15:00)
  const countdownEl = document.getElementById("countdown");
  if (countdownEl) {
    let t = 15*60;
    const tick = () => {
      const m = String(Math.floor(t/60)).padStart(2,"0");
      const s = String(t%60).padStart(2,"0");
      countdownEl.textContent = `${m}:${s}`;
      if (t-- <= 0) clearInterval(timer);
    };
    tick();
    const timer = setInterval(tick, 1000);
  }
})();
</script>

<script>
function renderBankIcons(invoice) {
  const icons = invoice?.urls || [];
  const bankDiv = document.getElementById("bank-icons");
  bankDiv.innerHTML = "";

  icons.forEach((u) => {
    const img = document.createElement("img");
    img.src = u.logo;
    img.alt = u.name;
    img.title = u.name;
    img.style.width = "50px";
    img.style.height = "50px";
    img.style.cursor = "pointer";
    img.style.borderRadius = "12px";
    img.style.boxShadow = "0 2px 6px rgba(0,0,0,0.1)";

    // üÜï –ë–∞–Ω–∫–Ω—ã icon –¥–∞—Ä–≤–∞–ª —Ç”©–ª–±”©—Ä —ç—Ö—ç–ª—Å—ç–Ω –≥—ç–∂ —Ç—ç–º–¥—ç–≥–ª—ç–Ω—ç
    img.onclick = () => {
      localStorage.setItem("lc_pay_started", "1");
      window.open(u.link, "_blank");
    };

    bankDiv.appendChild(img);
  });

  // ‚úÖ –≠–Ω—ç –º”©—Ä–∏–π–≥ —è–≥ –≠–ù–î –Ω—ç–º–Ω—ç ‚Äî render —Ö–∏–π–∂ –¥—É—É—Å—Å–∞–Ω—ã –¥–∞—Ä–∞–∞
  const payContent = document.querySelector(".pay-content");
  payContent?.classList.remove("solo");
}



document.addEventListener("DOMContentLoaded", async () => {
  const qrImg = document.querySelector(".qr-block img");

  const payload = {
  email: sessionStorage.getItem("wizardEmail") || localStorage.getItem("lc_email") || "",
  amount: 6900,
  testKey: localStorage.getItem("lc_test") || "burnout",
  testId: sessionStorage.getItem("testId") || localStorage.getItem("lc_testId") || "",
  riskLevel: (localStorage.getItem("lc_risk") || "low").toLowerCase(),
  scorePct: localStorage.getItem("lc_score") || 0,
  domainsScore: JSON.parse(localStorage.getItem("lc_domainsScore") || "[]")
};

  if (!payload.email) {
    alert("‚ùå –ò–º—ç–π–ª –æ–ª–¥—Å–æ–Ω–≥“Ø–π.");
    return;
  }

  try {
    const res = await fetch("https://api.lifecheck.mn/api/qpayCreateInvoice", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload),
    });
    const data = await res.json();

    if (data.ok && data.invoice) {
    localStorage.setItem("lc_invoice_id", data.invoice.invoice_id || "");
  // QPay-–∏–π–Ω invoice –¥–æ—Ç–æ—Ä qr_base64 —ç—Å–≤—ç–ª urls –±–∞–π–¥–∞–≥
  if (data.invoice.qr_image) {
    qrImg.src = "data:image/png;base64," + data.invoice.qr_image;
  } else if (data.invoice.urls && data.invoice.urls[0]) {
    qrImg.src = data.invoice.urls[0]; // fallback
  }

  // üè¶ –ë–∞–Ω–∫ –∞–ø–ø—É—É–¥—ã–Ω icon-—É—É–¥—ã–≥ render —Ö–∏–π—Ö
  renderBankIcons(data.invoice);

      // üÜï Invoice number-–∏–π–≥ –Ω—É—É—Å–∞–Ω element-–¥ —Ö–∞–¥–≥–∞–ª–∞—Ö
    const payNumEl = document.getElementById("pay-number");
    if (payNumEl)
  payNumEl.textContent =
    data.invoice.sender_invoice_no ||
    data.invoice.invoice_id ||
    data.invoice.id ||
    "";

    } else {
      alert("‚ùå QPay Invoice “Ø“Ø—Å–≥—ç–∂ —á–∞–¥—Å–∞–Ω–≥“Ø–π: " + (data.error || "Unknown error"));
    }
  } catch (err) {
    console.error("Invoice –∞–ª–¥–∞–∞:", err);
    alert("‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä—Ç—ç–π —Ö–æ–ª–±–æ–≥–¥–æ–∂ —á–∞–¥—Å–∞–Ω–≥“Ø–π.");
  }
});

</script>
<script>
(function () {
  const loading = document.getElementById("loading-block");
  const success = document.getElementById("success-block");
  const payContent = document.querySelector(".pay-content");

  function showLoading() {
  if (payContent) payContent.style.display = "flex";
  payContent?.classList.add("solo");
  if (success) success.style.display = "none";
  if (loading) loading.style.display = "block";
}

function showSuccess() {
  if (loading) loading.style.display = "none";
  if (payContent) payContent.style.display = "flex";
  payContent?.classList.add("solo");
  if (success) success.style.display = "block";
  try { localStorage.removeItem("lc_pay_started"); } catch(_) {}
}

  async function waitReportOnce() {
    const invoiceId = localStorage.getItem("lc_invoice_id");
    if (!invoiceId) return; // invoice “Ø“Ø—Å—ç—ç–≥“Ø–π –±–æ–ª —à–∞–ª–≥–∞—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞–≥“Ø–π

    showLoading();
    try {
      const res = await fetch(`https://api.lifecheck.mn/api/waitReport?invoice=${encodeURIComponent(invoiceId)}`, {
        method: "GET",
        headers: { "Cache-Control": "no-store" },
      });
      const data = await res.json();
      if (data && data.sent) {
        showSuccess();
      } else {
        // timeout —ç—Å–≤—ç–ª –∞–ª–¥–∞–∞ —Ç–æ—Ö–∏–æ–ª–¥–æ–ª–¥ –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –∑”©”©–ª”©–Ω —Ö—ç–ª–Ω—ç
        if (loading) {
          loading.innerHTML = `
            <p>–¢–∞–π–ª–∞–Ω–≥ –∏–ª–≥—ç—ç–∂ –±–∞–π–Ω–∞. –¢–∞ meantime –∏–º—ç–π–ª—ç—ç —à–∞–ª–≥–∞–∞—Ä–∞–π.</p>
          `;
        }
      }
    } catch (_) {
      if (loading) {
        loading.innerHTML = `<p>–°–µ—Ä–≤–µ—Ä—Ç—ç–π —Ö–æ–ª–±–æ–≥–¥–æ—Ö–æ–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞. –¢–∞ –∏–º—ç–π–ª—ç—ç —à–∞–ª–≥–∞–Ω–∞ —É—É.</p>`;
      }
    }
  }

  // –ë—É—Ü–∞–∂ –∏—Ä—ç—Ö “Ø–µ–¥ –Ω—ç–≥ —É–¥–∞–∞ —à–∞–ª–≥–∞–Ω–∞
  let tried = false;
function triggerOnce() {
  if (tried) return;
  // üß© –ó”©–≤—Ö”©–Ω —Ç”©–ª–±”©—Ä —ç—Ö–ª“Ø“Ø–ª—Å—ç–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω “Ø–µ–¥ —à–∞–ª–≥–∞–Ω–∞
  if (localStorage.getItem("lc_pay_started") !== "1") return;
  tried = true;
  waitReportOnce();
}

// QR —É–Ω—à—É—É–ª–∂ app —Ä—É—É –æ—Ä—Å–æ–Ω “Ø–µ–¥ —Ö—É—É–¥–∞—Å –∏—Ö—ç–≤—á–ª—ç–Ω hidden –±–æ–ª–Ω–æ.
// –¢—ç—Ä “Ø–µ–¥ —Ç”©–ª–±”©—Ä —ç—Ö—ç–ª—Å—ç–Ω –≥—ç–∂ —Ç—ç–º–¥—ç–≥–ª—ç–Ω—ç.
document.addEventListener("visibilitychange", () => {
  if (document.visibilityState === "hidden") {
    const inv = localStorage.getItem("lc_invoice_id");
    if (inv && !localStorage.getItem("lc_pay_started")) {
      localStorage.setItem("lc_pay_started", "1");
    }
  }
});

// –ë—É—Ü–∞–∂ –∏—Ä—ç—Ö—ç–¥ (visible –±–æ–ª–±–æ–ª) waitReport trigger —Ö–∏–π–Ω—ç
document.addEventListener("visibilitychange", () => {
  if (document.visibilityState === "visible") triggerOnce();
});


  window.addEventListener("focus", triggerOnce);
})();
</script>
</body>
</html>
